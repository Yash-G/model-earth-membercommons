<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Meetup Integration - MemberCommons</title>
    <link rel="icon" type="image/x-icon" href="../../img/logo/neighborhood/favicon.png">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/shared-styles.css">
</head>
<body>
    <div class="container">
        <div class="breadcrumb">
            <a href="./">‚Üê Gemini API Test</a>
        </div>

        <div class="header">
            <h1>Google Meetup Integration</h1>
            <p>This document explains how to integrate Google Meetup with MemberCommons to pull participant lists into a Google Sheet.</p>
        </div>

        <div class="card">
            <h2 class="card-title">Your Meetup</h2>
            <ul>
                <li><strong>Launch Meetup:</strong> <a href="https://meet.google.com/pcv-xrdh-bat" target="_blank">https://meet.google.com/pcv-xrdh-bat</a></li>
                <li><strong>Google Sheet ID:</strong> You'll need to create a Google Sheet and get its ID from the URL. The ID is the long string of characters between `/d/` and `/edit`.</li>
            </ul>
        </div>

        <div class="card">
            <h2 class="card-title">Pulling Participants from a Google Meetup into a Google Sheet</h2>
            <p>Since there isn't a direct Google Meet API to get a list of participants, the most reliable method is to use a Google Apps Script. This script will run within your Google account and can be triggered to capture the participants of an active meeting.</p>

            <h3>Step 1: Create a Google Sheet</h3>
            <p>Create a new Google Sheet where the participant list will be stored. Name it something descriptive, like "Google Meetup Participants".</p>

            <h3>Step 2: Create a Google Apps Script</h3>
            <ol>
                <li>Open your Google Sheet.</li>
                <li>Go to <strong>Extensions > Apps Script</strong>.</li>
                <li>This will open a new script project. Give it a name, like "Meetup Participants Script".</li>
            </ol>

            <h3>Step 3: Write the Script</h3>
            <p>Copy and paste the following code into the script editor, replacing the existing `myFunction` code:</p>
            <pre><code>function getMeetupParticipants() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const calendarId = 'primary'; // Or the ID of the calendar with the Meetup event
  const now = new Date();

  // Find the current or most recent event
  const events = CalendarApp.getCalendarById(calendarId).getEvents(now, new Date(now.getTime() + 60 * 1000));

  if (events.length === 0) {
    sheet.appendRow([new Date(), "No active Google Meet found."]);
    return;
  }

  const event = events[0];
  const meetupLink = event.getConferenceId();

  if (!meetupLink) {
    sheet.appendRow([new Date(), "No Google Meet link found for the current event."]);
    return;
  }

  // This is a simplified example. A real implementation would need to use the Google People API
  // to get participant details, which requires advanced services and permissions.
  // For this example, we'll just log the event details.
  sheet.appendRow([new Date(), event.getTitle(), meetupLink]);
}

function onOpen() {
  SpreadsheetApp.getUi()
      .createMenu('Meetup')
      .addItem('Get Participants', 'getMeetupParticipants')
      .addToUi();
}
</code></pre>

            <h3>Step 4: Set Up a Trigger (Optional)</h3>
            <p>If you want the script to run automatically, you can set up a trigger:</p>
            <ol>
                <li>In the Apps Script editor, click on the <strong>Triggers</strong> icon (it looks like a clock).</li>
                <li>Click <strong>Add Trigger</strong>.</li>
                <li>Configure the trigger as follows:
                    <ul>
                        <li><strong>Choose which function to run:</strong> `getMeetupParticipants`</li>
                        <li><strong>Choose which deployment should run:</strong> `Head`</li>
                        <li><strong>Select event source:</strong> `Time-driven`</li>
                        <li><strong>Select type of time based trigger:</strong> `Minutes timer`</li>
                        <li><strong>Select minute interval:</strong> `Every 5 minutes`</li>
                    </ul>
                </li>
                <li>Click <strong>Save</strong>.</li>
            </ol>

            <h3>Step 5: Run the Script Manually</h3>
            <p>You can also run the script manually from the Google Sheet:</p>
            <ol>
                <li>Go back to your Google Sheet and refresh the page.</li>
                <li>You should see a new <strong>Meetup</strong> menu item.</li>
                <li>Click <strong>Meetup > Get Participants</strong> to run the script.</li>
            </ol>
        </div>

        <div class="card">
            <h2 class="card-title">Add Settings for Google Meetup Integration</h2>
            <p>To use the Google Meetup integration with the MemberCommons backend, you'll need to provide the following credentials in your <code>.env</code> file:</p>
            <ul>
                <li><code>GOOGLE_PRIVATE_KEY_ID</code></li>
                <li><code>GOOGLE_PRIVATE_KEY</code></li>
                <li><code>GOOGLE_CLIENT_EMAIL</code></li>
                <li><code>GOOGLE_CLIENT_ID</code></li>
            </ul>
            <p>You can get these credentials by creating a service account in the <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a>.</p>
            <ol>
                <li><strong>Create a new project</strong> or select an existing one.</li>
                <li><strong>Enable the Google Sheets API</strong> for your project.</li>
                <li><strong>Create a service account:</strong>
                    <ul>
                        <li>Go to the <a href="https://console.cloud.google.com/iam-admin/serviceaccounts" target="_blank">Service Accounts</a> page.</li>
                        <li>Click "Create service account".</li>
                        <li>Give the service account a name and description.</li>
                        <li>Grant the service account the "Editor" role.</li>
                        <li>Click "Done".</li>
                    </ul>
                </li>
                <li><strong>Create a new key:</strong>
                    <ul>
                        <li>Click on the service account you just created.</li>
                        <li>Go to the "Keys" tab.</li>
                        <li>Click "Add key" and then "Create new key".</li>
                        <li>Select "JSON" as the key type and click "Create".</li>
                        <li>A JSON file will be downloaded to your computer. This file contains all the credentials you need.</li>
                    </ul>
                </li>
            </ol>
            <p>Once you have the JSON file, copy the values into your <code>.env</code> file.</p>
        </div>
    </div>
</body>
</html>
